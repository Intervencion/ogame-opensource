# Установка

Требования:
- Приличный веб-сервер
- PHP 7.x
- MySQL

## Настройка PHP

Немаловажная часть - это правильная настройка PHP.INI. Ниже перечислены важные параметры и значения, которые рекомендуется установить.

|Переменная PHP.INI|Описание|
|---|---|
|short_open_tag = On|Разрешает использование коротких включений PHP вида `<?= ... ?>`. Этот параметр обязательно должен быть включен, потому что короткие включения используются повсеместно в игровом движке.|
|max_execution_time = 200|Время выполнения скриптов. 200 секунд предостаточно для большинства задач. Бои уровня 20ккк потерь обрабатываются порядка 10-15 секунд, в зависимости от сервера.|
|display_errors = On|Показывать ошибки выполнения скриптов, по желанию.|
|variables_order = "EGPCS"|Порядок обработки глобальных переменных.|
|magic_quotes_gpc = On|Экранирование строк с кавычками. Все игровые скрипты предполагают, что строки экранированы по умолчанию.|

Необходимые расширения:
- extension=php_gd2.dll
- extension=php_mbstring.dll
- extension=php_mysql.dll

## Подготовка файлов

В корень вашего сервера нужно скопировать всё содержимое из папки `wwwroot`.

Папку `game` нужно копировать в инстанцию Вселенной.

## Создание поддомена Вселенной

Если вы разворачиваете в Web и не хотите иметь одну вселенную в корне с игрой, то можно создать поддомен типа `uni1.mygame.com` и положить папку `game` туда.

Если вы хотите иметь просто одну вселенную там же, где и главная страница, просто положите папку `game` в корень вашего веб-сервера.

## Боевой движок

Нужно собрать исполняемый файл боевого движка, как написано в папке `BattleEngine` и положить исполняемый файл куда требуется.

## Инсталляция мастер базы

После первого открытия неустановленной игры вас попросят инициализировать мастер-базу:

![install1.png](/imgstore/install1.png)

Укажите все данные (MySQL БД должна быть создана отдельно какими-то другими средствами, какими вам нравится, например с помощью Navicat MySQL).

![install2.png](/imgstore/install2.png)

## Настройка Вселенной

Для настройки вселенной нужно перейти по прямой ссылке на страницу установки, например: http://localhost/game/install.php

![install3.png](/imgstore/install3.png)

Обязательно нужно отметить галочку и указать настройки master базы, чтобы вселенная стала доступна с главной страницы.

## Проверка правильности установки

Для проверки достаточно зайти во вселенную под ником `legor` (админ). 

В админке можно проверить боевой движок в разделе Симулятор. Если всё работает хорошо, должен быть адекватный боевой доклад.

Потыкать разные кнопочки в админке; Походить по страницам; Попробовать что-то построить у Легора и проверить очередь команд.

## Внешние ссылки

Оригинальная игра содержит ряд ссылок из бокового меню на внешние ресурсы. Вы можете поменять их по своему усмотрению в файле game/page.php:
- Форум
- Туториал
- Правила
- О нас

## Деинсталляция

- Удалить config.php из корня сервера и config.php из папки game
- Очистить все базы данных (master базу и базу вселенной)
